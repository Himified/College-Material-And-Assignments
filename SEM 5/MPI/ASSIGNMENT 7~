start: nop
;QUESTION 1
IN 00H    ;INPUT THE NUMBER WHOSE FACTORIAL HAS TO BE FOUND AT PORT 0
MOV C,A   ;STORE THE NUMBER IN REG. C
MVI B,01H ;REG. B IS USED TO CALCULATE THE FACTORIAL
FACTORIAL: CALL MULTIPLY
           DCR C      ;SUPPOSE 5! => (5*4*3*2*1)(5 TIMES)
           JNZ FACTORIAL
           MOV A,B
           OUT 01H    ;DISPLAY THE FINAL FACTORIAL AT PORT 1
           JMP PROG2
MULTIPLY: MOV D,C     ;GET NO OF TIMES NUMBER HAS TO BE MULTIPLIED IN REG. D
	  MVI A,00H   ;INITIALIZE ACC TO STORE RESULT

MULTIPLYLOOP:  ADD B
	       DCR D
               JNZ MULTIPLYLOOP
	       MOV B,A ;STORE CURRENT RESULT IN REG. B
	       RET

;QUESTION 2
PROG2: IN 02H ;NO. OF TERMS INPUT AT PORT 2
MOV C,A       ;GET THE NO. OF TERMS TO BE PRINTED IN REG. C
LXI H,3000H   ;STARTING ADDRESS OF RESULT
MVI A,00H
MOV M,A       ;STORE THE FIRST TERM 00H AT 3000H
INX H
DCR C
JZ PROG3      ;IF ONLY ONE TERM THEN END
MVI A,01H
MOV M,A       ;STORE THE SECOND TERM 01H AT 3001H
INX H
DCR C
JZ PROG3      ;IF ONLY TWO TERMS THEN END
SERIES: CALL NEXTNUM  ;SUBROUTINE TO FIND THE NEXT NUMBER IN SERIES
	DCR C         ;DECREMENT NO. OF TERMS
	JNZ SERIES
	JMP PROG3

NEXTNUM: DCX H     ;GET THE PREVIOUS NUMBER   
	 MOV A,M
	 DCX H
	 ADD M     ;ADD THE PREVIOUS NUMBER WITH NUMBER BEFORE IT
    	 INX H 
	 INX H
	 MOV M,A   ;STORE THE SUM(OF PREVIOUS TWO TERMS) AT THE CORRECT LOCATION
	 INX H     ;INCREMENT HL PAIR TO POINT TO NEXT MEM. LOCATION
	 RET

;QUESTION 3
PROG3: LXI H,4000H
MOV B,M            ;STORE FIRST OPERAND IN REG. B
INX H
XRA A              ;CLEAR ACCUMULATOR
MOV C,A            ;STORE 00H IN REG. C FOR CARRY
MULTIPLY2: CALL MULTIPLYLOOP2
	   INX H
	   MOV M,C ;STORE REG. C CONTENT IN MEMORY
	   INX H
	   MOV M,A ;STORE ACC. CONTENT IN MEMORY
	   JMP END

MULTIPLYLOOP2: ADD M
	       JNC SKIP
	       INR C     ;INCREASE REG. C WHEN CARRY=1
               SKIP: DCR B
                     JNZ MULTIPLYLOOP2
	      RET

END: hlt